<!doctype html>
<meta charset="UTF-8"> 

<head>
  <title>StrainWebTool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">  

  <!--  Bootstral loading  -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
  <!-- add after bootstrap.min.css -->
  <link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.0/dist/bootstrap-toc.min.css">
  <link rel="stylesheet" href="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/css/ol.css" type="text/css">
  <script src="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/build/ol.js"></script>
  <!-- The line below is only needed for old environments like Internet Explorer and Android 4.x -->
<!--  <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=requestAnimationFrame,Element.prototype.classList,URL"></script>    -->
  <!-- github icon -->
  <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>


<!--   <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.4/Chart.min.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>
  <!-- add after bootstrap.min.js -->
  <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.0/dist/bootstrap-toc.min.js"></script>

  <link rel="icon" https://raw.githubusercontent.com/DSOlab/StrainTool/gh-pages/img/DSOtrans.png" type="image/x-icon">
<!--   custom css styles  -->
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/webtool.css') }}" />

  <!--  LEAFLET CSS  -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.css"/>

  <!--  LEAFLET JS  -->
  <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.js"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='js/leaflet.easyPrint.js') }}"></script>


<!-- MARKER CLUSTER -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.Default.css" />
  <script src="https://unpkg.com/leaflet.markercluster@1.3.0/dist/leaflet.markercluster.js"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='js/leaflet.polylineDecorator.js') }}"></script>  
  
<!-- JS to prnt coordinates on map -->
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='js/Leaflet.Coordinates-0.1.5.css') }}"/>
  <script type="text/javascript" src="{{ url_for('static', filename='js/Leaflet.Coordinates-0.1.5.min.js') }}"></script>  
<script>
  $(document).ready(function() {
  $('.sev_check').each(function() {
//     $(this).addClass('unselected');
  });
  $('.sev_check').on('click', function() {
//     $(this).toggleClass('unselected');
//     $(this).toggleClass('selected');
  $('.sev_check').not(this).prop('checked', false);
//     $('.sev_check').not(this).removeClass('selected');
//     $('.sev_check').not(this).addClass('unselected');
    });
  });
</script>
<script>
function includeHTML() {
  var z, i, elmnt, file, xhttp;
  /* Loop through a collection of all HTML elements: */
  z = document.getElementsByTagName("*");
  for (i = 0; i < z.length; i++) {
    elmnt = z[i];
    /*search for elements with a certain atrribute:*/
    file = elmnt.getAttribute("w3-include-html");
    if (file) {
      /* Make an HTTP request using the attribute value as the file name: */
      xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4) {
          if (this.status == 200) {elmnt.innerHTML = this.responseText;}
          if (this.status == 404) {elmnt.innerHTML = "Page not found.";}
          /* Remove the attribute, and call this function once more: */
          elmnt.removeAttribute("w3-include-html");
          includeHTML();
        }
      } 
      xhttp.open("GET", file, true);
      xhttp.send();
      /* Exit the function: */
      return;
    }
  }
}
</script>

</head>

<body data-spy="scroll" data-target="#toc">

<!-- ADD header -->
<div w3-include-html="{{ url_for('static', filename='html/header.html') }}"></div>

<!-- ADD help bar -->
<div w3-include-html="{{ url_for('static', filename='help/help-bar.html') }}"></div>

<div class="container-fluid">

<!-- Main application -->
<div class="row" style="height: 750px;">

    <!-- Strain Tool arguments column -->
    <div class="col-md-2" style="padding: 20px; background-color:  #b3d9ff;">
        <div class="row">
<!--             <div class="col col-md-2"></div> -->
            <div class="col">
              <div class="input-group input-group-sm mb-">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-sm"><b>Velocity file</b></span>
                    </div>
                <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="{{ input_file }}" disabled>
              </div>
              <div class="input-group input-group-sm mb-">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-sm"><b>Stations Used</b></span>
                    </div>
                <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="{{ NoSta }}" disabled>
              </div>
            </div>
        </div>
        
        <!--select method sen or veis          -->
        <div class="row">
            <div class="col">
            <div class="input-group input-group-sm mb-">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-sm"><b>Selected method</b></span>
                    </div>
                <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="{{ args.method }}" disabled>
              </div>
              <div class="input-group input-group-sm mb-">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-sm"><b>Estimated Tensors</b></span>
                    </div>
                  <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="{{ NoTensors }}" disabled>
              </div>
<!--                 Select method:<br> -->
<!--                 {{ method }} -->
                <!-- Shen Method-->
                <!--<div class="custom-control custom-checkbox custom-control-inline">
                <input type="checkbox" class="custom-control-input sev_check" id="defaultInline1" checked disabled>
                <label class="custom-control-label" for="defaultInline1">Shen</label>
                </div>-->
                <!-- Veis, Delaunay triangles-->
                <!--<div class="custom-control custom-checkbox custom-control-inline">
                <input type="checkbox" class="custom-control-input sev_check" id="defaultInline2" disabled>
                <label class="custom-control-label" for="defaultInline2">Veis</label>
                </div>-->
            </div>
        </div>
        <!-- Set Boundary zone  -->
        <div class="row">
            <div class="col">
                Boundary zone:<br>
                <div class="input-group">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="">Lon.(λ)</span>
                </div>
                <input type="text" class="form-control" placeholder="{{ lonmin }}" disabled>
                <input type="text" class="form-control" placeholder="{{ lonmax }}" disabled>
                </div>
                
                <div class="input-group">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="">Lat.(φ)</span>
                </div>
                <input type="text" class="form-control" placeholder="{{ latmin }}" disabled>
                <input type="text" class="form-control" placeholder="{{ latmax }}" disabled>
                </div>
                <br>
                <div class="input-group">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="">Grid-Step</span>
                </div>
                {% if args.method == 'veis' %}
                  <input type="text" class="form-control" placeholder="" disabled>
                  <input type="text" class="form-control" placeholder="" disabled>
                {% else %}
                  <input type="text" class="form-control" placeholder="{{ x_step }}" disabled>
                  <input type="text" class="form-control" placeholder="{{ y_step }}" disabled>
                {% endif %}
                
                </div>
            </div>
        </div>
        <!-- Set Model parameters  -->
        <div class="row">
            <div class="col">
                Imterpolation model parameters:<br>
                <div class="input-group input-group-sm mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-sm">Wt</span>
                    </div>
                    {% if args.method == 'veis' %}
                        <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="" disabled>
                    {% else %}
                        <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="{{ args.Wt }}" disabled>
                    {% endif %}

                </div>
                <div class="input-group input-group-sm mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-sm">D min</span>
                    </div>
                    {% if args.method == 'veis' %}
                        <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="" disabled>
                    {% else %}
                        <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="{{ args.dmin }}" disabled>
                    {% endif %}               
                </div>
                <div class="input-group input-group-sm mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-sm">D max</span>
                    </div>
                    {% if args.method == 'veis' %}
                        <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="" disabled>
                    {% else %}
                        <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="{{ args.dmax }}" disabled>
                    {% endif %}    
                </div>
                <div class="input-group input-group-sm mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-sm">D step</span>
                    </div>
                    {% if args.method == 'veis' %}
                        <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="" disabled>
                    {% else %}
                        <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="{{ args.dstep }}" disabled>
                    {% endif %}
                </div>
                OR set:<br>
                <div class="input-group input-group-sm mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-sm">D parameter</span>
                    </div>
                     {% if args.method == 'veis' %}
                        <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="" disabled>
                    {% else %}
                        <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="{{ args.d_coef }}" disabled>
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- Set arguments for python --> 
        <div class="row">
            <div class="col">
                Special arguments:<br>
                <!-- Default checked -->
                <div class="custom-control custom-checkbox">
                {% if args.cut_outoflim_sta == False %}
                  <input type="checkbox" class="custom-control-input" id="cut_stations"  disabled>
                {% else %}
                  <input type="checkbox" class="custom-control-input" id="cut_stations"  disabled checked>
                {% endif %}
                  <label class="custom-control-label" for="cut_stations">cut excess stations</label>
                </div> 
                <div class="custom-control custom-checkbox">
                {% if args.generate_stats == False %}
                  <input type="checkbox" class="custom-control-input" id="g_statistic" disabled>
                {% else %}
                  <input type="checkbox" class="custom-control-input" id="g_statistic" disabled checked>
                {% endif %}
                <label class="custom-control-label" for="g_statistic">generate statistics</label>
                </div> 
            </div>
        </div>
        <div align="center">
            <button type="button" class="btn btn-danger"><a class="new_calc" href="{{ rooturl_folder }}/inputs">New Calculation</a></button>
        </div>
    </div>
    <!-- Strain Tool Argments finished      -->
    
    <!-- Plot cases -->
    <div class="col-md-2" style="padding: 20px; background-color:  #fff2e6;">
        <div class="row">
            <div class="col">
            Strain parameters: <br>
                <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input sev_check" id="plot_vel" name="verify" value="N" disabled >
                <label class="custom-control-label" for="plot_vel">Velocities</label>
                </div> 
                <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input sev_check" id="plot_strain" name="verify" value="Y" disabled >
                <label class="custom-control-label" for="plot_strain">Principal Axis</label>
                </div> 
                <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input sev_check" id="plot_rotation" disabled >
                <label class="custom-control-label" for="plot_rotation">Rotational Rates</label>
                </div> 
                <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input sev_check" id="plot_gtot" disabled >
                <label class="custom-control-label" for="plot_gtot">Shear Strain</label>
                </div>
                <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input sev_check" id="plot_gtotaxes" disabled >
                <label class="custom-control-label" for="plot_gtotaxes">Shear Strain Axes</label>
                </div>
                <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input sev_check" id="plot_secinv" disabled >
                <label class="custom-control-label" for="plot_secinv">Second Invariant</label>
                </div>
            Statistics:
                <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input sev_check" id="stat_stations" disabled >
                <label class="custom-control-label" for="stat_stations">Stations per cell</label>
                </div> 
                <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input sev_check" id="stat_doptimal" disabled >
                <label class="custom-control-label" for="stat_doptimal">D optimal</label>
                </div> 
                <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input sev_check" id="stat_sigma" disabled >
                <label class="custom-control-label" for="stat_sigma">sigma value</label>
                </div>
            </div>
 
        </div>
        <div class="row">
            <div class="col" align="center">
                <button type="button" class="btn btn-danger" disabled>ADD to Map</button>
            </div>
        </div>
        
        <div class="row">
            <div class="col">
                Create GMT Maps: <br>
                Options:<br>
                <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="gmt_stations" disabled >
                <label class="custom-control-label" for="gmt_stations">plot stations</label>
                </div> 
                <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="gmt_labels" disabled >
                <label class="custom-control-label" for="gmt_labels">add labels</label>
                </div> 
                <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="gmt_deltr" disabled >
                <label class="custom-control-label" for="gmt_deltr">add delaunay triangles</label>
                </div>
            Scales:
                <div class="input-group input-group-sm mb-">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-sm">velocities</span>
                    </div>
                <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="NaN" disabled >
                </div>
                <div class="input-group input-group-sm mb-">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-sm">Strains</span>
                    </div>
                <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="NaN" disabled >
                </div>
                <div class="input-group input-group-sm mb-">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="inputGroup-sizing-sm">Rotational</span>
                    </div>
                <input type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" placeholder="NaN" disabled >
                </div>
            Outputs:
                <div class="input-group">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="">Pre/Suf-fix</span>
                </div>
                <input type="text" class="form-control" placeholder="NaN" disabled >
                <input type="text" class="form-control" placeholder="NaN" disabled >
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col" align="center">
                <button type="button" class="btn btn-danger" disabled >GMT Map</button>
            </div>
        </div>
    
    </div>
    <div class="col-md-8">
<!--     maps -->
    <div id="map" style="width:100%;height:100%;margin:0px;margin:0px;border:1px solid black;"></div>
<!--     <div id="map-canvas" style="width:100%;height:100%;margin:0px;margin:0px;border:1px solid black;"></div> -->

<!-- <iframe width="100%" height="100%" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://www.openstreetmap.org/export/embed.html?bbox=11.502685546875002%2C33.61461929233378%2C29.849853515625%2C41.623655390686395&amp;layer=mapnik" style="border: 1px solid black"></iframe> -->
     <!--Google map-->
        <!--<div id="map-container-google-1" class="z-depth-1-half map-container" >
        <iframe src="https://maps.google.com/maps?ll=39.1811459,23.0690025,7.13z=15&ie=UTF8&iwloc=&output=embed" frameborder="0"
            style="border:0" allowfullscreen></iframe>
        </div>-->

<!--Google Maps-->

    </div>
    
    
    
    
   
    </div>
</div>

<div class="row" style="height: 25px; background-color: #e69900"></div>
<div class="row" style="height: 25px;">
<div class="col-md-1"></div>
<div class="col-md-11"><h4>Results</h4></div>
<!-- <div class="col-md-8"></div> -->
</div>
<!-- Results -->
<div class="row">
    <div class="col">
<!--     <h3>Results</h3> -->
<ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="pills-input-tab" data-toggle="pill" href="#pills-input" role="tab" aria-controls="pills-input" aria-selected="true">Input Velocities</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="pills-straininfo-tab" data-toggle="pill" href="#pills-straininfo" role="tab" aria-controls="pills-straininfo" aria-selected="false">Strain Info</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="pills-statistics-tab" data-toggle="pill" href="#pills-statistics" role="tab" aria-controls="pills-statistics" aria-selected="false">Statistics</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="pills-download-tab" data-toggle="pill" href="#pills-download" role="tab" aria-controls="pills-download" aria-selected="false">Download Files</a>
  </li>
</ul>
<div class="tab-content" id="pills-tabContent">
  <div class="tab-pane fade show active" id="pills-input" role="tabpanel" aria-labelledby="pills-input-tab">
        <table class="table table-striped">
          <thead>
            <tr>
              <th scope="col">Station</th>
              <th scope="col">Latitude (<sup>o</sup>)</th>
              <th scope="col">Longtitude (<sup>o</sup>)</th>
              <th scope="col">Vn (mm/yr)</th>
              <th scope="col">Ve (mm/yr)</th>
              <th scope="col">σVn (mm/yr)</th>
              <th scope="col">σVe (mm/yr)</th>
              <th scope="col">rho (/)</th>
              <th scope="col">T (yrs)</th>
            </tr>
          </thead>
          <tbody>
            {% for station in content %}
              <tr>
              <th scope="row">{{ station.name }}</th>
                <td>{{ station.lat }}</td>
                <td>{{ station.lon }}</td>
                <td>{{ station.ve }}</td>
                <td>{{ station.vn }}</td>
                <td>&plusmn; {{ station.se }}</td>
                <td>&plusmn; {{ station.sn }}</td>
                <td> {{ station.rho }}</td>
                <td>{{ station.t }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      <hr>
  </div>
  <div class="tab-pane fade" id="pills-straininfo" role="tabpanel" aria-labelledby="pills-straininfo-tab">
    <table class="table table-striped">
      <thead>
        <tr>
          <th scope="col">Lat. (<sup>o</sup>)</th>
          <th scope="col">Lon. (<sup>o</sup>)</th>
          <th scope="col">emax </th>
<!--           <th scope="col">demax</th> -->
          <th scope="col">emin</th>
<!--           <th scope="col">demin</th> -->
          <th scope="col">Az<sub>emax</sub> (<sup>o</sup>)</th>
<!--           <th scope="col">dAz<sub>emax</sub> (<sup>o</sup>)</th> -->
          <th scope="col">Rotational</th>
<!--           <th scope="col">dw</th> -->
          <th scope="col">Shear</th>
<!--           <th scope="col">dShear</th> -->
          <th scope="col">Dilatation</th>
          <th scope="col">2nd Invariant</th>
        </tr>
      </thead>
      <tbody>
        {% for str in strain_info %}
        <tr>
          <td>{{ str.lat }}</td>
          <td>{{ str.lon }}</td>
          <td>{{ str.emax }} &plusmn; {{ str.demax }}</td>
<!--           <td>{{ str.demax }}</td> -->
          <td>{{ str.emin }} &plusmn; {{ str.demin }}</td>
<!--           <td>{{ str.demin }}</td> -->
          <td>{{ str.azi }} &plusmn; {{ str.dazi }}</td>
<!--           <td>{{ str.dazi }}</td> -->
          <td>{{ str.w }} &plusmn; {{ str.dw }}</td>
<!--           <td>{{ str.dw }}</td> -->
          <td>{{ str.shr }} &plusmn; {{ str.dshr }}</td>
<!--           <td>{{ str.dshr }}</td> -->
          <td>{{ str.dilat }} &plusmn; {{ str.ddilat }}</td>
          <td>{{ str.secinv }} &plusmn; {{ str.dsecinv }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <div class="tab-pane fade" id="pills-statistics" role="tabpanel" aria-labelledby="pills-statistics-tab">Not available yet!!</div>
  
  <div class="tab-pane fade" id="pills-download" role="tabpanel" aria-labelledby="pills-download-tab">
    <table class="table table-striped">
      <thead>
        <tr>
          <th> No. </th> <th>Description</th> <th> file </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th> 1. </th>
          <th> Stations used </th>
          <th><a href="{{ rooturl_folder }}/outputs/station_info.dat" target="_blank">station_info.dat</a></th>
        </tr>
        <tr>
          <th> 2. </th>
          <th> Strain paramemeters </th>
          <th><a href="{{ rooturl_folder }}/outputs/strain_info.dat" target="_blank">strain_info.dat</a></th>
        </tr>
        {% if args.method == 'shen' %}
        <tr>
          <th> 3. </th>
          <th> Statistics </th>
          <th><a href="{{ rooturl_folder }}/outputs/strain_stats.dat" target="_blank">strain_stats.dat</a></th>
        </tr>
        {% endif %}
        {% if args.method == 'veis' %}
        <tr>
          <th> 3. </th>
          <th>Delaunay Triangles</th>
          <th><a href="{{ rooturl_folder }}/outputs/delaunay_info.dat" target="_blank">delaunay_info.dat</a></th>
        <tr>
        {% endif %}
      </tbody>
    </table>
  </div>

</div>
        
        
        
    </div>
</div>

 
<!-- <script src="http://www.openlayers.org/api/OpenLayers.js"></script> -->
<script type="text/javascript">


  var lonlatarray=[
  {% for station in content %}
    [ "{{ station.name }}", {{ station.lat }}, {{ station.lon }}, {{ station.vn }}, {{ station.ve }}, {{ station.sn }}, {{ station.se }}, {{ station.t }} ],
  {% endfor %}
//         [ name, 0, 0 ]
  ];
  
  var strinfo=[
    {% if args.method == 'shen' %}
      {% for str in strain_info %}
        [ {{ str.lat }}, {{ str.lon }}, {{ str.emax }}, {{ str.demax }}, {{ str.emin }}, {{ str.demin }}, {{ str.azi }}, {{ str.dazi }}, {{ str.w }}, {{ str.dw }}, {{ str.shr }}, {{ str.dshr }}, {{ str.dilat }}, {{ str.ddilat }}, {{ str.secinv }} , {{ str.dsecinv }} ],
      {% endfor %}
    {% else %}
      {% for str in strain_info %}
        [ {{ str.lat }}, {{ str.lon }}, {{ str.emax }}, 0, {{ str.emin }}, 0, {{ str.azi }}, 0, {{ str.w }}, 0, {{ str.shr }}, 0, {{ str.dilat }}, 0, {{ str.secinv }}, 0 ],
      {% endfor %}
    {% endif %}
  ];
  
  var dlntrinfo = [
    {% for tr in dlntr_info %}
      [ {{ tr.lat1 }}, {{ tr.lon1 }}, {{ tr.lat2 }}, {{ tr.lon2 }},  {{ tr.lat3 }}, {{ tr.lon3 }}],
    {% endfor %}
  ]
  
  var stations = L.layerGroup();
  for (var i = 0; i < lonlatarray.length; i++) {
    L.circleMarker([lonlatarray[i][1], lonlatarray[i][2]], {
                    radius: 3,
                    fillColor: "#FFFF4D",
                    color: "#000",
                    weight: 1,
                    opacity: 1,
                    fillOpacity: 0.4
                })
    .bindPopup('CODE: ' + lonlatarray[i][0] +
    '<br>  Lat = ' + lonlatarray[i][1] +
    '<br>  Lon = ' + lonlatarray[i][2] +
    '<br>  Vn = ' + lonlatarray[i][3] + 
    '<br>  Ve = ' + lonlatarray[i][4] +
    '<br>  sn = ' + lonlatarray[i][5] +
    '<br>  se = ' + lonlatarray[i][6] +
    '<br>  Time = ' + lonlatarray[i][7]
    )
    .addTo(stations);
  }
  
    function getCol(matrix, col){
       var column = [];
       for(var i=0; i<matrix.length; i++){
          column.push(matrix[i][col]);
       }
       return column;
    }
  
  {% if args.one_tensor == False and args.method == 'shen' %}  
    var grid = L.layerGroup();
    var x_cell = ({{ grd.x_max}} - {{ grd.x_min }})/{{ grd.x_step }};
    var y_cell = ({{ grd.y_max}} - {{ grd.y_min }})/{{ grd.y_step }};
    for (var i = 0; i <= x_cell; i++) {
      var lon1 = {{ grd.x_min }} + i*{{ grd.x_step }};
      var lon2 = {{ grd.x_min }} + i*{{ grd.x_step }};
      L.polyline([[{{ grd.y_min }}, lon1], [{{ grd.y_max }}, lon2]], {color: 'gray', weight: 1, opacity: 0.7}).addTo(grid);
    }
    for (var i = 0; i <= y_cell; i++) {
      var lat1 = {{ grd.y_min }} + i*{{ grd.y_step }};
      var lat2 = {{ grd.y_min }} + i*{{ grd.y_step }};
      L.polyline([[lat1, {{ grd.x_min }} ], [lat2, {{ grd.x_max}}]], {color: 'gray', weight: 1, opacity: 0.7}).addTo(grid);
    }
  {% endif %}
  
  
  {% if args.one_tensor == False and args.method == 'veis' %}  
    var dlntr = L.layerGroup();
    for (var i = 0; i < dlntrinfo.length; i++) {
      L.polyline([[dlntrinfo[i][0], dlntrinfo[i][1]], [dlntrinfo[i][2], dlntrinfo[i][3]], [dlntrinfo[i][4], dlntrinfo[i][5]]], {color: 'gray', weight: 1, opacity: 0.7}).addTo(dlntr);
    }
  {% endif %}

  
  
  var vel = L.layerGroup();
  var maxvn = Math.max.apply(Math, getCol(lonlatarray,3));
  var minvn = Math.min.apply(Math, getCol(lonlatarray,3));
  var maxve = Math.max.apply(Math, getCol(lonlatarray,4));
  var minve = Math.min.apply(Math, getCol(lonlatarray,4)); 
  for (var i = 0; i < lonlatarray.length; i++) {
    var lat2 = lonlatarray[i][1] + lonlatarray[i][3]/((maxvn - minvn)/2);
    var lon2 = lonlatarray[i][2] + lonlatarray[i][4]/((maxve - minve)/2);
    var velline = L.polyline([[lonlatarray[i][1],lonlatarray[i][2]], [lat2, lon2]], {color: 'blue'})
    .bindPopup('CODE: ' + lonlatarray[i][0] +
    '<br>  Lat = ' + lonlatarray[i][1] +
    '<br>  Lon = ' + lonlatarray[i][2] +
    '<br>  Vn = ' + lonlatarray[i][3] + 
    '<br>  Ve = ' + lonlatarray[i][4] +
    '<br>  sn = ' + lonlatarray[i][5] +
    '<br>  se = ' + lonlatarray[i][6] +
    '<br>  Time = ' + lonlatarray[i][7]
    )
    .addTo(vel);
     var velarrow = L.polylineDecorator(velline, {
       patterns: [
       {
         offset: '100%',
         repeat: 0,
         symbol: L.Symbol.arrowHead({pixelSize: 10, polygon: false, pathOptions: {stroke: true, color: 'blue'}})
       }
     ]
     }).addTo(vel);
  }
  
     var lat2sc = {{ grd.y_min }} + 1 + 0/((maxvn - minvn)/2);
     var lon2sc = {{ grd.x_min }} - 4*{{ grd.x_step }} + (maxvn > maxve ? maxvn : maxve)/((maxve - minve)/2);
     var arrowsc = L.polyline([[{{ grd.y_min }} + 1,{{ grd.x_min }} - 4*{{ grd.x_step }}], [lat2sc, lon2sc]], {color: 'black'})
     .bindTooltip("<b>" + (maxvn > maxve ? maxvn : maxve) +" mm/y</b>", {
      permanent: true,
      offset: L.point({x: -40, y: 30})	
    })     
     .addTo(vel);
     
     
    var arrowscHead = L.polylineDecorator(arrowsc, {
            patterns: [
                {
                    offset: '100%',
                    repeat: 0,
                    symbol: L.Symbol.arrowHead({pixelSize: 10, polygon: false, pathOptions: {stroke: true, color: 'black'}})
                }
            ]
        }).addTo(vel);
  
  
  var strain = L.layerGroup();
  var max_emax = Math.max.apply(Math, getCol(strinfo,2));
  var min_emax = Math.min.apply(Math, getCol(strinfo,2));
  var max_emin = Math.max.apply(Math, getCol(strinfo,4));
  var min_emin = Math.min.apply(Math, getCol(strinfo,4));
  
//   if (max_emax > Math.abs(max_emin)) {
//     var str_scale = 2*(Math.abs(max_emax) - Math.abs(min_emax));
//   } else {
//     var str_scale = 2*(Math.abs(max_emin) - Math.abs(min_emin));
//   }
{% if args.one_tensor == False %}  
  var str_scale = ((max_emax+max_emin) - (min_emax + min_emin))
{% else %}
  var str_scale = (max_emin*3)
{% endif %}
  for (var i = 0; i < strinfo.length; i++) {
	  var emax_lat1 = strinfo[i][0] + strinfo[i][2]*Math.cos(strinfo[i][6]*Math.PI/180)/str_scale;
	  var emax_lon1 = strinfo[i][1] + strinfo[i][2]*Math.sin(strinfo[i][6]*Math.PI/180)/str_scale;
    var emax_lat2 = strinfo[i][0] - strinfo[i][2]*Math.cos(strinfo[i][6]*Math.PI/180)/str_scale;
    var emax_lon2 = strinfo[i][1] - strinfo[i][2]*Math.sin(strinfo[i][6]*Math.PI/180)/str_scale;
    L.polyline([[emax_lat1, emax_lon1], [emax_lat2, emax_lon2]], {color: 'red'})
    .bindPopup('Lat = ' + strinfo[i][0] +
    '<br>  Lon = ' + strinfo[i][1] + 
    '<br>  <b>emax = ' + strinfo[i][2] + '&plusmn;' + strinfo[i][3] +
    '<br>  emin = ' + strinfo[i][4] + '&plusmn;' + strinfo[i][5] +
    '<br>  Az = ' + strinfo[i][6] + '&plusmn;' + strinfo[i][7] +
    '</b><br>  W = ' + strinfo[i][8] + '&plusmn;' + strinfo[i][9] +
    '<br>  Shear = ' + strinfo[i][10] + '&plusmn;' + strinfo[i][11] +
    '<br>  Dilat. = ' + strinfo[i][12] + '&plusmn;' + strinfo[i][13] +
    '<br>  2nd inv. = ' + strinfo[i][14] + '&plusmn;' + strinfo[i][15]
    )
    .addTo(strain);
  }

  
  for (var i = 0; i < strinfo.length; i++) {
	  var emin_lat1 = strinfo[i][0] + strinfo[i][4]*Math.sin(strinfo[i][6]*Math.PI/180)/str_scale;
	  var emin_lon1 = strinfo[i][1] - strinfo[i][4]*Math.cos(strinfo[i][6]*Math.PI/180)/str_scale;
    var emin_lat2 = strinfo[i][0] - strinfo[i][4]*Math.sin(strinfo[i][6]*Math.PI/180)/str_scale;
    var emin_lon2 = strinfo[i][1] + strinfo[i][4]*Math.cos(strinfo[i][6]*Math.PI/180)/str_scale;
    L.polyline([[emin_lat1, emin_lon1], [emin_lat2, emin_lon2]], {color: 'blue'})
    .bindPopup('Lat = ' + strinfo[i][0] +
    '<br>  Lon = ' + strinfo[i][1] + 
    '<br><b>  emax = ' + strinfo[i][2] + '&plusmn;' + strinfo[i][3] +
    '<br>  emin = ' + strinfo[i][4] + '&plusmn;' + strinfo[i][5] +
    '<br>  Az = ' + strinfo[i][6] + '&plusmn;' + strinfo[i][7] +
    '</b><br>  W = ' + strinfo[i][8] + '&plusmn;' + strinfo[i][9] +
    '<br>  Shear = ' + strinfo[i][10] + '&plusmn;' + strinfo[i][11] +
    '<br>  Dilat. = ' + strinfo[i][12] + '&plusmn;' + strinfo[i][13] +
    '<br>  2nd inv. = ' + strinfo[i][14] + '&plusmn;' + strinfo[i][15]
    )
    .addTo(strain);
  }

  {% if args.one_tensor == False %}  
     var lat2str = {{ grd.y_min }}  + 0/((maxvn - minvn)/2);
     
     var lon2str = {{ grd.x_min }} - 4*{{ grd.x_step }} + (max_emax > max_emin ? 2*max_emax : 2*max_emin)/(str_scale);
     var arrowstr = L.polyline([[{{ grd.y_min }},{{ grd.x_min }} - 4*{{ grd.x_step }}], [lat2str, lon2str]], {color: 'black'})
     .bindTooltip("<b>" + (max_emax > max_emin ? max_emax : max_emin) +" nstrain/y</b>", {
      permanent: true,
      offset: L.point({x: -40, y: 30})	
    })     
     .addTo(strain);
  {% endif %}
     /*
     
    var arrowscHead = L.polylineDecorator(arrowsc, {
            patterns: [
                {
                    offset: '100%',
                    repeat: 0,
                    symbol: L.Symbol.arrowHead({pixelSize: 10, polygon: false, pathOptions: {stroke: true, color: 'black'}})
                }
            ]
        }).addTo(vel);*/

  
  
  
  
  var STRlegend = L.control({position: 'topright'});
  STRlegend.onAdd = function (map) {
      var div = L.DomUtil.create('div', 'legend');
      div.innerHTML += "<h4>Principal Axes</h4>";
      div.innerHTML += '<i style="background:#FF0000 "></i><span>Extension</span><br>';
  div.innerHTML += '<i style="background:#0000FF "></i><span>Compression</span><br>';
            
//             div.innerHTML = labels.join('<br>');
            return div;
        };
  
// CREATE color palete
//   var color_pal = [ "#0066cc", "#0080ff", "#1a8cff", "#66b3ff", "#cce6ff", "#e6e6ff", "#ffebee", "#ff8080", "#ff4d4d", "#ff0000", "#cc0000"];
//   var color_pal = ["#0174DF", "#0080FF", "#2E9AFE", "#58ACFA", "#81BEF7", "#A9D0F5", "#CEE3F6", "#E0ECF8", "#F8E0E0", "#F6CECE", "#F5A9A9", "#F78181", "#FA5858", "#FE2E2E", "#FF0000", "#DF0101" ];
//   var color_pal = ["#0000ff",	"#0080ff",	"#00bfff",	"#00ffff",	"#00ffbf",	"#00ff80",	"#bfff00",	"#ffbf00",	"#ffbf00",	"#ff9900",	"#ff8000",	"#ff6600",	"#ff4c00",	"#ff3300",	"#ff1a00",	"#ff0000"]'

  var color_pal = [ "#1500ff", "#05f", "#007fff", "#00bfff", "#0ff", "#00ffbf", "#00ff80", "#0f0", "#80ff00", "#bfff00", "#ff0", "#ffbf00", "#ff8000", "#f60", "#ff2b00", "#f00" ];


  function create_scale(min,max,feature) {
    var step = (max - min)/15;
    var lim1 = min-0.0001;
    var lim2 = min+step;
    for (var i = 0; i <= 15; i++) {
    if (feature > lim1 && feature <= lim2 ) {
      return {
                    radius: 7,
                    fillColor: color_pal[i],
                    color: "#000",
                    weight: 0,
                    opacity: 1,
                    fillOpacity: 1
                }
    }
      var lim1 = lim1 + step;
      var lim2 = lim1 + step;

    }
  }
  
  var shear = L.layerGroup();
  var shrmin = Math.min.apply(Math, getCol(strinfo,10));
  var shrmax = Math.max.apply(Math, getCol(strinfo,10));
  for (var i = 0; i < strinfo.length; i++) {
    L.circleMarker([strinfo[i][0], strinfo[i][1]], create_scale(shrmin,shrmax,strinfo[i][10]))
    .bindPopup('Lat = ' + strinfo[i][0] +
    '<br>  Lon = ' + strinfo[i][1] + 
    '<br>  emax = ' + strinfo[i][2] + '&plusmn;' + strinfo[i][3] +
    '<br>  emin = ' + strinfo[i][4] + '&plusmn;' + strinfo[i][5] +
    '<br>  Az = ' + strinfo[i][6] + '&plusmn;' + strinfo[i][7] +
    '<br>  W = ' + strinfo[i][8] + '&plusmn;' + strinfo[i][9] +
    '<b><br>  Shear = ' + strinfo[i][10] + '&plusmn;' + strinfo[i][11] +
    '</b><br>  Dilat. = ' + strinfo[i][12] + '&plusmn;' + strinfo[i][13] +
    '<br>  2nd inv. = ' + strinfo[i][14] + '&plusmn;' + strinfo[i][15]
    )
    .addTo(shear);
  }
  
      
{% if args.one_tensor == False %}  
  var SHRlegend = L.control({position: 'topright'});
  SHRlegend.onAdd = function (map) {
     var div = L.DomUtil.create('div', 'legend'),
                grades = [],
                labels = [],
                from, to;
    var step = (shrmax - shrmin)/16;
    var lim1 = shrmin;
    
    for (var i = 0; i <= 16; i++) {
      grades.push(lim1);
      var lim1 = lim1 + step;
    }
    
    div.innerHTML = labels.push('<p4 style="text-align:center">Shear Strain</p4>');
    div.innerHTML = labels.push('<p5 style="text-align:center">(nstrain/y)</p5>');
    for (var i = 0; i < grades.length - 1 ; i++) {
      from = grades[i];
      to = grades[i + 1];

      labels.push(
        '<i style="background:' + color_pal[i] + '"></i> ' +
            from.toFixed(1) + ' &ndash; ' + to.toFixed(1) );
    }
    
    div.innerHTML = labels.join('<br>');
    return div;
  };
{% endif %}
  
  var dilatation = L.layerGroup();
  var dilmin = Math.min.apply(Math, getCol(strinfo,12));
  var dilmax = Math.max.apply(Math, getCol(strinfo,12));
  for (var i = 0; i < strinfo.length; i++) {
    L.circleMarker([strinfo[i][0], strinfo[i][1]], create_scale(dilmin,dilmax,strinfo[i][12]))
    .bindPopup('Lat = ' + strinfo[i][0] +
    '<br>  Lon = ' + strinfo[i][1] + 
    '<br>  emax = ' + strinfo[i][2] + '&plusmn;' + strinfo[i][3] +
    '<br>  emin = ' + strinfo[i][4] + '&plusmn;' + strinfo[i][5] +
    '<br>  Az = ' + strinfo[i][6] + '&plusmn;' + strinfo[i][7] +
    '<br>  W = ' + strinfo[i][8] + '&plusmn;' + strinfo[i][9] +
    '<br>  Shear = ' + strinfo[i][10] + '&plusmn;' + strinfo[i][11] +
    '<b><br>  Dilat. = ' + strinfo[i][12] + '&plusmn;' + strinfo[i][13] +
    '</b><br>  2nd inv. = ' + strinfo[i][14] + '&plusmn;' + strinfo[i][15]
    )
    .addTo(dilatation);
  }

{% if args.one_tensor == False %}  
  var DILlegend = L.control({position: 'topright'});
  DILlegend.onAdd = function (map) {
     var div = L.DomUtil.create('div', 'legend'),
                grades = [],
                labels = [],
                from, to;
    var step = (dilmax - dilmin)/16;
    var lim1 = dilmin;
    
    for (var i = 0; i <= 16; i++) {
      grades.push(lim1);
      var lim1 = lim1 + step;
    }
    
    div.innerHTML = labels.push('<p4 style="text-align:center">Dilatation</p4>');
    div.innerHTML = labels.push('<p5 style="text-align:center">(nstrain/y)</p5>');
    for (var i = 0; i < grades.length - 1 ; i++) {
      from = grades[i];
      to = grades[i + 1];

      labels.push(
        '<i style="background:' + color_pal[i] + '"></i> ' +
            from.toFixed(1) + ' &ndash; ' + to.toFixed(1) );
    }
    
    div.innerHTML = labels.join('<br>');
    return div;
  };
{% endif %}
  
  
  var secinv = L.layerGroup();
  var sinvmin = Math.min.apply(Math, getCol(strinfo,14));
  var sinvmax = Math.max.apply(Math, getCol(strinfo,14));
  for (var i = 0; i < strinfo.length; i++) {
    L.circleMarker([strinfo[i][0], strinfo[i][1]], create_scale(sinvmin,sinvmax,strinfo[i][14]))
    .bindPopup('Lat = ' + strinfo[i][0] +
    '<br>  Lon = ' + strinfo[i][1] + 
    '<br>  emax = ' + strinfo[i][2] + '&plusmn;' + strinfo[i][3] +
    '<br>  emin = ' + strinfo[i][4] + '&plusmn;' + strinfo[i][5] +
    '<br>  Az = ' + strinfo[i][6] + '&plusmn;' + strinfo[i][7] +
    '<br>  W = ' + strinfo[i][8] + '&plusmn;' + strinfo[i][9] +
    '<br>  Shear = ' + strinfo[i][10] + '&plusmn;' + strinfo[i][11] +
    '<br>  Dilat. = ' + strinfo[i][12] + '&plusmn;' + strinfo[i][13] +
    '<b><br>  2nd inv. = ' + strinfo[i][14]  + '&plusmn;' + strinfo[i][15] + '</b>'
    )
    .addTo(secinv);
  }

{% if args.one_tensor == False %}  
  var SINVlegend = L.control({position: 'topright'});
  SINVlegend.onAdd = function (map) {
     var div = L.DomUtil.create('div', 'legend'),
                grades = [],
                labels = [],
                from, to;
    var step = (sinvmax - sinvmin)/16;
    var lim1 = sinvmin;
    
    for (var i = 0; i <= 16; i++) {
      grades.push(lim1);
      var lim1 = lim1 + step;
    }
    
    div.innerHTML = labels.push('<p4 style="text-align:center">2nd Invariant</p4>');
    div.innerHTML = labels.push('<p5 style="text-align:center">(nstrain/y)</p5>');
    for (var i = 0; i < grades.length - 1 ; i++) {
      from = grades[i];
      to = grades[i + 1];

      labels.push(
        '<i style="background:' + color_pal[i] + '"></i> ' +
            from.toFixed(1) + ' &ndash; ' + to.toFixed(1) );
    }
    
    div.innerHTML = labels.join('<br>');
    return div;
  };
{% endif %}

	var mbAttr = 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
			'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
		mbUrl = 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw';

	var Esri_WorldPhysical = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}', {
          attribution: 'Tiles &copy; Esri &mdash; Source: US National Park Service'}),
        Esri_WorldImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
	  attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'}),
	grayscale   = L.tileLayer(mbUrl, {id: 'mapbox.light', attribution: mbAttr}),
		streets  = L.tileLayer(mbUrl, {id: 'mapbox.streets',   attribution: mbAttr}),
        Esri_WorldTopoMap = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}', {
         attribution: 'Tiles &copy; Esri &mdash; Esri the GIS User Community'});

	var map = L.map('map', {
		center: [{{ clat }}, {{ clon }}],
		layers: [Esri_WorldTopoMap, strain]
	});

	
	
	var southWest = new L.LatLng({{ grd.y_min }}, {{ grd.x_min }}),
      northEast = new L.LatLng({{ grd.y_max }}, {{ grd.x_max }}),
      bounds = new L.LatLngBounds(southWest, northEast);
  map.fitBounds(bounds, {padding: [10,10]});
        
	var baseLayers = {
		"Principal Axes": strain,
		"Shear Strain": shear,
		"Dilatation": dilatation,
		"2nd Invariant": secinv
	};

	var overlays = {
		"Stations": stations,
		"Velocities": vel
  {% if args.one_tensor == False and args.method == 'shen' %}  
,
		"Grid": grid
  {% endif %}
  {% if args.one_tensor == False and args.method == 'veis' %}  
,
		"Delaunay Tr": dlntr
  {% endif %}
		};

	L.control.layers(baseLayers, overlays, {collapsed:false}).addTo(map);
	

//   Add scale Bar
  L.control.scale().addTo(map);

//   L.control.coordinates().addTo(map);
// 		//add configured controls
// 		L.control.coordinates({
// 			position:"bottomleft",
// 			decimals:2,
// 			decimalSeperator:",",
// 			labelTemplateLat:"Latitude: {y}",
// 			labelTemplateLng:"Longitude: {x}"
// 		}).addTo(map);
		L.control.coordinates({
			position:"bottomleft",
// 			useDMS:true,
			labelTemplateLat:"N {y}",
			labelTemplateLng:"E {x}",
			useLatLngOrder:true
		}).addTo(map);
//     L.control.coordinates({
// 			position:"bottomleft",
// 			useDMS:true,
// 			labelTemplateLat:"N {y}",
// 			labelTemplateLng:"E {x}",
// 			useLatLngOrder:true
// 		}).addTo(map);
$('<h6 id="mapTitle"><b>Strain parameters</b></h6>').insertBefore('div.leaflet-control-layers-base');



{% if args.one_tensor == False %}  

STRlegend.addTo(map);
currentLegend = STRlegend;

map.on('baselayerchange', function (eventLayer) {
    if (eventLayer.name === 'Principal Axes') {
        map.removeControl(currentLegend );
        currentLegend = STRlegend;
        STRlegend.addTo(map);
    }
    else if  (eventLayer.name === 'Shear Strain') {
        map.removeControl(currentLegend );
        currentLegend = SHRlegend;
        SHRlegend.addTo(map);
    }
    else if  (eventLayer.name === 'Dilatation') {
       map.removeControl(currentLegend );
        currentLegend = DILlegend;
        DILlegend.addTo(map);
    }
    else if  (eventLayer.name === '2nd Invariant') {
       map.removeControl(currentLegend );
        currentLegend = SINVlegend;
       SINVlegend.addTo(map);
    }
  })
{% endif %}

//  Add Watermark

L.Control.Watermark = L.Control.extend({
        onAdd: function(map) {
                var img = L.DomUtil.create('img');

                img.src = 'static/img/SWTlogo.png';
                img.style.width = '200px';

                return img;
        },

        onRemove: function(map) {
// Nothing to do here
        }
});

L.control.watermark = function(opts) {
        return new L.Control.Watermark(opts);
}

L.control.watermark({ position: 'bottomright' }).addTo(map);

  
L.easyPrint({
	title: 'Print button',
	position: 'topleft',
	elementsToHide: 'p, h2',
	sizeModes: ['A4Landscape', 'A4Portrait'],
	hideControlContainer: false
}).addTo(map);

</script>

</div><!--end of container div  -->
</body>


<!-- ADD FOOTER stable html -->
<div w3-include-html="{{ url_for('static', filename='html/footer.html') }}"></div>

  
<script>
includeHTML();
</script> 
</html>
